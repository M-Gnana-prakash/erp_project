<div class="relative w-80 calendar-wrapper">
  @if (label) {
    <label [class]="{
            'text-xs': sizeVariant === 'sm',
            'text-sm': sizeVariant === 'md',
            'text-base': sizeVariant === 'lg'
        }" class="font-medium text-gray-700 mb-1">
        {{ label }} @if(required){<span class="text-red-500">*</span>}
    </label>
    }
 
  <!-- Input -->
  <div class="relative">
    <input [disabled]="disabled" readonly (click)="toggle()" [value]="format(start) + (end ? ' â€“ ' + format(end) : '')"
      placeholder="Enter a date range" class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-md
             focus:ring-2 focus:ring-blue-500 cursor-pointer bg-white
             disabled:bg-gray-100 disabled:cursor-not-allowed" />

    <span (click)="toggle()" class="absolute right-3 top-1/2 -translate-y-1/2 text-blue-600 cursor-pointer">
      ðŸ“…
    </span>
  </div>

  <!-- Popup -->
  <div *ngIf="show" class="absolute z-50 mt-2 bg-white rounded-lg shadow-xl w-80 overflow-hidden">

    <!-- Header -->
    <div class="bg-gray-100 px-4 py-3 flex justify-between items-center">

      <div class="flex items-center gap-2 font-semibold text-gray-700">

        <select class="border rounded px-2 py-1 text-sm" [value]="current.getMonth()"
          (change)="setMonth($any($event.target).value)">

          <option *ngFor="let m of months; let i = index" [value]="i">
            {{ m }}
          </option>

        </select>

      </div>

      <div class="flex gap-2 text-gray-600">
        <button (click)="change(-1)">â€¹</button>
        <button (click)="change(1)">â€º</button>
      </div>

    </div>

    <!-- Weekdays -->
    <div class="grid grid-cols-7 text-center text-xs text-gray-500 py-2 border-b">
      <div *ngFor="let d of ['S','M','T','W','T','F','S']">
        {{ d }}
      </div>
    </div>

    <!-- Dates -->
    <div class="grid grid-cols-7 text-center p-3 gap-y-2 text-sm">

      <div *ngFor="let d of days" (click)="select(d)" class="relative cursor-pointer">

        <!-- Range background -->
        <div *ngIf="inRange(d)" class="absolute inset-0 bg-blue-100">
        </div>

        <!-- Date circle -->
        <div class="relative z-10 w-8 h-8 mx-auto flex items-center justify-center rounded-full" [ngClass]="{
            'bg-blue-600 text-white': isEdge(d),
            'hover:bg-gray-200': !isEdge(d)
          }">
          {{ d.getDate() }}
        </div>

      </div>

    </div>

  </div>

</div>